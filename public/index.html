<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cabrino AI Ultimate</title>
<style>
body { margin:0; font-family:sans-serif; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); color:#fff; display:flex; flex-direction:column; height:100vh; }
#chat { flex:1; overflow-y:auto; padding:20px; }
#input { display:flex; padding:10px; background:rgba(0,0,0,0.3); }
#msg { flex:1; padding:10px; border-radius:5px; border:none; }
button { padding:10px 20px; margin-left:10px; border:none; border-radius:5px; cursor:pointer; background:#ff4c00; color:#fff; }
p { margin:5px 0; }
.typing { font-style:italic; color:#ccc; }
</style>
</head>
<body>
<div id="chat"></div>
<div id="input">
<input type="text" id="msg" placeholder="Ã‰cris ton message..."/>
<button onclick="send()">Envoyer</button>
<button onclick="startVoice()">ðŸŽ¤ Parler</button>
</div>

<script>
async function send(){
  const message = document.getElementById("msg").value;
  if(!message) return;
  document.getElementById("chat").innerHTML += "<p>ðŸ‘¤ " + message + "</p>";
  document.getElementById("msg").value = "";
  document.getElementById("chat").innerHTML += '<p class="typing">ðŸ¤– Ã©crit...</p>';
  const res = await fetch("/chat", { method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify({message}) });
  const data = await res.json();
  document.querySelector(".typing").remove();
  document.getElementById("chat").innerHTML += "<p>ðŸ¤– " + data.reply + "</p>";
  speak(data.reply);
}

function speak(text){
  const speech = new SpeechSynthesisUtterance(text);
  speech.lang = "fr-FR";
  speech.pitch = 1;
  speech.rate = 1;
  speechSynthesis.speak(speech);
}

function startVoice(){
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  recognition.lang = "fr-FR";
  recognition.onresult = function(event){
    document.getElementById("msg").value = event.results[0][0].transcript;
    send();
  }
  recognition.start();
}
</script>
</body>
</html>
